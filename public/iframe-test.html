<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iframe Navigation Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        
        h1 {
            color: #2a3b31;
        }
        
        .iframe-container {
            width: 100%;
            margin: 20px 0;
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 5px;
        }
        
        iframe {
            width: 100%;
            height: 500px;
            border: 1px solid #ccc;
        }
        
        .button-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }
        
        button {
            padding: 10px 15px;
            background-color: #2a9d8f;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        
        button:hover {
            background-color: #238f83;
        }
        
        .console-output {
            background-color: #f5f5f5;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            margin: 20px 0;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <h1>Iframe Navigation Test for Yuca Media</h1>
    
    <p>
        This page loads pages in an iframe to test navigation issues without leaving this page.
        Examine the console for any errors that occur during navigation attempts.
    </p>
    
    <div class="console-output" id="console-log">
        Console output will appear here
    </div>
    
    <div class="button-container">
        <button onclick="loadInIframe('/public/index.html')">Load Home Page</button>
        <button onclick="loadInIframe('/public/services.html')">Load Services Page Directly</button>
        <button onclick="loadInIframe('/public/direct-link.html')">Load Test Page</button>
        <button onclick="createDirectLink()">Create Direct Link Element</button>
    </div>
    
    <div id="direct-link-container"></div>
    
    <div class="iframe-container">
        <iframe id="test-iframe" src="about:blank" title="Test Navigation Frame"></iframe>
    </div>
    
    <script>
        // Function to load a page in the iframe
        function loadInIframe(url) {
            const iframe = document.getElementById('test-iframe');
            console.log('Loading in iframe: ' + url);
            logToPage('Loading in iframe: ' + url);
            
            iframe.src = url;
            
            // Monitor iframe load events
            iframe.onload = function() {
                console.log('Iframe loaded: ' + url);
                logToPage('Iframe loaded: ' + url);
                
                try {
                    // Try to access iframe content (may fail due to same-origin policy)
                    const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    console.log('Iframe document title: ' + iframeDoc.title);
                    logToPage('Iframe document title: ' + iframeDoc.title);
                } catch (e) {
                    console.error('Cannot access iframe content: ' + e.message);
                    logToPage('ERROR: Cannot access iframe content: ' + e.message);
                }
            };
            
            iframe.onerror = function() {
                console.error('Error loading iframe content');
                logToPage('ERROR: Error loading iframe content');
            };
        }
        
        // Function to create a direct link to test
        function createDirectLink() {
            const container = document.getElementById('direct-link-container');
            const linkHtml = `
                <div style="margin: 20px 0; padding: 15px; background-color: #f0f0f0; border-radius: 5px;">
                    <p><strong>Test these direct links:</strong></p>
                    <ul style="margin-top: 10px;">
                        <li><a href="/public/services.html" target="_blank">Open Services Page in New Tab</a></li>
                        <li><a href="services.html" target="_blank">Open Services Page with Relative Path in New Tab</a></li>
                        <li><a href="http://localhost:3000/public/services.html" target="_blank">Open Services Page with Full URL in New Tab</a></li>
                    </ul>
                </div>
            `;
            
            container.innerHTML = linkHtml;
            console.log('Direct link elements created');
            logToPage('Direct link elements created');
        }
        
        // Function to log to the page
        function logToPage(message) {
            const consoleOutput = document.getElementById('console-log');
            const logLine = document.createElement('div');
            logLine.textContent = message;
            
            if (message.startsWith('ERROR:')) {
                logLine.style.color = 'red';
            }
            
            consoleOutput.appendChild(logLine);
            
            // Auto-scroll to bottom
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        }
        
        // Capture console output
        (function() {
            const oldConsoleLog = console.log;
            const oldConsoleError = console.error;
            
            console.log = function(message) {
                oldConsoleLog.apply(console, arguments);
                logToPage(typeof message === 'object' ? JSON.stringify(message) : message);
            };
            
            console.error = function(message) {
                oldConsoleError.apply(console, arguments);
                logToPage('ERROR: ' + (typeof message === 'object' ? JSON.stringify(message) : message));
            };
        })();
        
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Iframe testing page loaded');
            console.log('Current URL: ' + window.location.href);
        });
    </script>
</body>
</html>
